syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.cashpilot.userservice.grpc";
option java_outer_classname = "UserProfileProto";

import "google/protobuf/empty.proto";
import "validate/validate.proto";

service UserProfileService {
  rpc GetUserProfile(GetUserProfileRequest) returns (UserProfileResponse);

  rpc CreateUserProfile(CreateUserProfileRequest) returns (UserProfileResponse);

  rpc UpdateUserProfile(UpdateUserProfileRequest) returns (UserProfileResponse);

  rpc DeleteUserProfile(DeleteUserProfileRequest) returns (google.protobuf.Empty);
}

message GetUserProfileRequest {
  // user_id должен быть непустым
  string user_id = 1 [(validate.rules).string.min_len = 1];
}

message CreateUserProfileRequest {
  // user_id обязателен
  string user_id = 1 [(validate.rules).string.min_len = 1];

  // username — минимум 3 символа
  string username = 2 [(validate.rules).string = {min_len: 3, max_len: 30}];

  // email — должен быть корректным форматом email
  string email = 3 [(validate.rules).string.email = true];
}

message UpdateUserProfileRequest {
  // user_id обязателен
  string user_id = 1 [(validate.rules).string.min_len = 1];

  // first_name и last_name — не пустые, но не длиннее 50 символов
  string first_name = 2 [(validate.rules).string = {min_len: 1, max_len: 50}];
  string last_name = 3 [(validate.rules).string = {min_len: 1, max_len: 50}];

  // default_currency должен быть из допустимого списка
  string default_currency = 4 [
    (validate.rules).string = {in: ["USD", "EUR", "KZT", "GBP", "RUB"]}
  ];
}

message UserProfileResponse {
  string user_id = 1;
  string username = 2;
  string email = 3;
  string first_name = 4;
  string last_name = 5;
  string default_currency = 6;
}

message DeleteUserProfileRequest {
  // user_id обязателен
  string user_id = 1 [(validate.rules).string.min_len = 1];
}